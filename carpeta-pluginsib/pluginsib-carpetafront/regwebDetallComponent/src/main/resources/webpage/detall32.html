<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ca" lang="ca">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>${detalletitle}</title>
    <link rel="shortcut icon" type="image/x-ico" href="http://www.caib.es/sites/favicon.png">
    <meta http-equiv="Content-Language" content="ca">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="_csrf" content="">
    <meta name="_csrf_header" content="">
    <!-- SCRIPTS -->
    <script src="${resources}/carpeta/jquery-3.5.0.js"></script>
    <script src="${resources}/carpeta/popper.min.js"></script>
    <script src="${resources}/carpeta/bootstrap.min.js"></script>
    <!-- Datetimpicker -->
    <script src="${resources}/carpeta/moment-with-locales.min.js"></script>
    <script src="${resources}/carpeta/bootstrap-datetimepicker.js"></script>
    <!-- Del Goib -->
    <!--    <script src="${resources}/carpeta/globales.js" type="text/javascript"></script>-->
    <!-- DataTables -->
    <script src="${resources}/carpeta/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="${resources}/carpeta/datetime-moment.js" type="text/javascript"></script>
    <!-- ESTILS -->
    <link href="${resources}/carpeta/bootstrap.min.css" rel="stylesheet">
    <link href="${resources}/carpeta/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="${resources}/carpeta/goib.css" rel="stylesheet">
    <link href="${resources}/carpeta/carpeta.css" rel="stylesheet">
    <link href="${resources}/carpeta/open-iconic-bootstrap.css" rel="stylesheet">
    <link href="${resources}/carpeta/jquery.dataTables.min.css" rel="stylesheet">
    <link href="${resources}/carpeta/datatables.min.css" rel="stylesheet">
</head>

<body class="fonsPlugin">

<div id="carregantDetallRegistre" class="loader-container centrat loaderOcult">
    <div class="loader"></div>
</div>

<script type="text/javascript">

	$(document).ready(function(){
	    $('#estatInfo').click(function(){
	        if ($('#tooltipDetall').is (':hidden'))
	            $('#tooltipDetall').show();
	        else
	            $('#tooltipDetall').hide();
	        return false;
	    });
	
	    $('body,html').click(function(){
	        $('#tooltipDetall').hide();
	    });
	});

    function mostrarCarregantDetall() {
        $("#carregantDetallRegistre").removeClass("loaderOcult");
    }

    function amagarCarregantDetall() {
        $("#carregantDetallRegistre").addClass("loaderOcult");
    }

    function descarregarJustificant(){
        window.open('${justificanteUrl}')
    }

    function generantJustificant(){
        window.location.replace('${urlGeneracioJustificant}')
    }

    function descarregarAnnex(idAnnexe) {
        window.location.replace('${urlAnnexe}' + idAnnexe);
    }

</script>
<!-- Contenido -->
<div class="container-contenido">
    <div class="infoNoMenu">
        <h2 class="titol h2">${registro_titulo_detalle} NUM REG ${registro.numeroRegistro}</h2>

        <div class="col-md-12 border-0 float-left p-0">

            <div class="card-body pl-0 pr-0">

                <div class="row">

                    <div class="pri-col-deta-reg col-md-6">

                        <div class="card border-left-carpeta shadow py-2 mb-3">

                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="font-weight-bold verde text-uppercase mb-3 text-center h3">${registro_entrada}</div>

                                        <dl class="row">
                                            <dt class="col-sm-3 pb-2">${registro_fecha}</dt>
                                            <dd class="col-sm-7">${registro.fechaRegistro?string("dd-MM-yyyy HH:mm")}</dd>

                                            <dt class="col-sm-3 pb-2">${registro_numero}</dt>
                                            <dd class="col-sm-7">${registro.numeroRegistro}</dd>

                                            <dt class="col-sm-3 pb-2">${registro_oficina}</dt>
                                            <dd class="col-sm-7"><#if registro.denominacionOficinaOrigen?has_content >${registro.denominacionOficinaOrigen}</#if></dd>

                                            <dt class="col-sm-3 pb-2">${registro_destinatario}</dt>
                                            <dd class="col-sm-7"><#if registro.denominacionDestino?has_content >${registro.denominacionDestino}</#if></dd>

                                            <dt class="col-sm-3 pb-2">${registro_tipo_doc}</dt>
                                            <dd class="col-sm-7"><#if registro.tipoDocumetacionFisica?has_content >${registro.tipoDocumetacionFisica}</#if></dd>

                                            <dt class="col-sm-3 pb-2">${registro_extracto}</dt>
                                            <dd class="col-sm-7"><#if registro.extracto?has_content >${registro.extracto}</#if></dd>

                                            <dt class="col-sm-3 pb-2">${carpeta_idioma}</dt>
                                            <dd class="col-sm-7"><#if registro.idioma?has_content >${registroIdioma[registro.idioma]}</#if></dd>

                                            <dt class="col-sm-3 pb-2">${registro_estado}</dt>
                                            <dd class="col-sm-7">
                                                <#if registro.estado?has_content >
                                                <div id="tooltipDetall" data-toggle="tooltip" data-placement="top" title="" class="tooltipClicable">${registroExplicacionEstado[registro.estado]}</div>${registroEstado[registro.estado]} <a href="#" id="estatInfo"><span class="oi oi-info pl-2"></span></a>
                                                </#if>
                                            </dd>

                                            <!-- Descripcion estado muestra el valor del campo decodificacionTipoAnotacion de un registro -->
                                            <#if registro.descripcionEstado?has_content >
                                                <dt class="col-sm-3 pb-2">${registro_descripcion_estado}</dt>
                                                <dd class="col-sm-7">${registro.descripcionEstado}</dd>
                                            </#if>

                                            <dt class="col-sm-3 pb-2">${registro_presencial}</dt>
                                            <dd class="col-sm-7">${registro.isPresencial()?then('SÃ­', 'No')}</dd>

                                            <#if registro.codigoSia?has_content >
                                                <dt class="col-sm-3 pb-2">${registro_codigoSia}</dt>
                                                <dd class="col-sm-7">${registro.codigoSia?long?c}</dd>
                                            </#if>

                                        </dl>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card border-left-carpeta shadow py-2 mb-3">
                            <div class="card-body">
                                <div class="row no-gutters">
                                    <div class="col mr-2">
                                        <div class="font-weight-bold verde text-uppercase mb-3 text-center h3">${registro_justificante}</div>

                                        <#if justificanteUrl?has_content>
                                            <div class="text-center">
                                                <button type="button" class="d-sm-inline-block btn btn-sm btn-danger shadow-sm" onclick="descarregarJustificant()"><span class="oi oi-data-transfer-download mr-2" title="" alt="" aria-hidden="true"></span>${carpeta_descargar}</button>
                                            </div>
                                        </#if>

                                        <#if justificanteId?has_content>
                                            <div class="text-center">
                                                <button type="button" class="d-sm-inline-block btn btn-sm btn-danger shadow-sm" onclick="descarregarAnnex('${justificanteId?long?c}')"><span class="oi oi-data-transfer-download mr-2" title="" alt="" aria-hidden="true"></span> ${carpeta_descargar}</button>
                                            </div>
                                        </#if>
                                        <#if !justificanteUrl?has_content && !justificanteId?has_content && error?has_content>
                                            <div class="text-center">
                                                <button type="button" class="d-sm-inline-block btn btn-sm btn-danger shadow-sm" onclick="generantJustificant()"><span class="oi oi-data-transfer-download mr-2" title="" alt="" aria-hidden="true"></span> ${carpeta_descargar}</button>
                                            </div>
                                            <div class="text-center pt-3 text-danger">
                                                <span class="oi oi-warning pr-1"> </span>${error}
                                            </div>
                                        </#if>
                                        <#if !justificanteUrl?has_content && !justificanteId?has_content && !error?has_content>
                                            <div class="text-center">
                                             <button type="button" class="d-sm-inline-block btn btn-sm btn-danger shadow-sm" onclick="generantJustificant()"><span class="oi oi-data-transfer-download mr-2" title="" alt="" aria-hidden="true"></span> ${carpeta_descargar}</button>
                                            </div>
                                        </#if>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="seg-col-deta-reg col-md-5 pr-0">

                        <div class="card border-left-carpeta shadow py-2 mb-3">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="font-weight-bold verde text-uppercase mb-3 text-center h3"> ${registro_interesados}</div>
                                        <div class="row no-gutters align-items-center">

                                            <table class="table table-hover table-sm">
                                                <thead>
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">${registro_interesado_nombre}</th>
                                                    <th scope="col">${registro_interesado_documento}</th>
                                                    <th scope="col">${registro_interesado_tipo}</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <#list registro.interesados as interesado >
                                                <tr>
                                                    <td>${interesado?index+1}</td>
                                                    <td>
                                                        ${interesado.interesado.nombre}
                                                        <#if interesado.interesado.apellido1?has_content >${interesado.interesado.apellido1}</#if>
                                                        <#if interesado.interesado.apellido2?has_content >${interesado.interesado.apellido2}</#if>
                                                    </td>
                                                    <td><#if interesado.interesado.documento?has_content >${interesado.interesado.documento}</#if></td>
                                                    <td>${tipoInteresado[interesado.interesado.tipoInteresado]}</td>
                                                </tr>

                                                </#list>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card border-left-carpeta shadow py-2 mb-3">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="font-weight-bold verde text-uppercase mb-3 text-center h3">${registro_anexos}</div>
                                        <#if registro.anexos?has_content >
                                        <table class="table table-sm table-hover">
                                            <thead>
                                            <tr>
                                                <th scope="col">#</th>
                                                <th scope="col">${registro_anexo_name}</th>
                                                <th scope="col">${registro_anexo_validezdocumento}</th>
                                                <!--<th scope="col">${registro_anexo_size}</th>-->
                                                <th scope="col">${registro_anexo_file}</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <#list registro.anexos as anexo >
                                            <tr>
                                                <td>${anexo?index +1}</td>
                                                <td>${anexo.name}</td>
                                                <td><#if anexo.validezDocumento?has_content >
                                                        <#if validezDocumento[anexo.validezDocumento]?has_content >
                                                            ${validezDocumento[anexo.validezDocumento]}
                                                        </#if>
                                                    </#if>
                                                </td>
                                                <#if anexo.mime?has_content >
                                                <!--<td>${anexo.size} KB</td>-->
                                                <td><button type="button" class="d-sm-inline-block btn btn-sm btn-danger shadow-sm" onclick="descarregarAnnex('${anexo.fileID?long?c}')"><span class="oi oi-data-transfer-download" title="" alt="" aria-hidden="true"></span></button></td>
                                                <#else>
                                                    <td colspan="3"><span>${registro_anexo_nodisponible}</span></td>
                                                </#if>
                                            </tr>
                                            </#list>
                                            </tbody>
                                        </table>
                                        <#else>

                                        <!-- No hay anexos -->
                                        <p class="text-center">${registro_anexos_vacio}</p>

                                        </#if>
                                        <p class="text-md-left pt-4" style="font-size: small">${registro_anexos_nodisponibles}</p>

                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
        </div>


    </div>

    </div>
</div>

</body>
</html>
